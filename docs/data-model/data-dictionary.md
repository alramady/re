_# Data Dictionary â€” Munsiq Platform

This document provides a detailed description of the tables and columns in the Munsiq database schema. For relationships, see the [ERD](./erd.mmd).

## Table: `users`

Stores user accounts for the platform.

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `UUID` | No | Primary Key, unique identifier for the user. | `a1b2c3d4-e5f6-7890-1234-567890abcdef` |
| `role_id` | `UUID` | No | Foreign key to the `roles` table. | `f0e9d8c7-b6a5-4321-fedc-ba9876543210` |
| `name` | `VARCHAR(255)` | No | User's full name. | `Abdullah Al-Amoudi` |
| `email` | `VARCHAR(255)` | No | User's unique email address, used for login. | `user@example.com` |
| `password_hash` | `VARCHAR(255)` | No | Hashed password (using bcrypt). | `$2b$12$...` |
| `created_at` | `TIMESTAMPTZ` | No | Timestamp of when the user was created. | `2026-02-16 10:00:00+03` |
| `updated_at` | `TIMESTAMPTZ` | No | Timestamp of the last update. | `2026-02-16 10:00:00+03` |

## Table: `properties`

Stores information about real estate properties managed by a tenant.

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `UUID` | No | Primary Key, unique identifier for the property. | `b1c2d3e4-f5a6-b7c8-d9e0-f1a2b3c4d5e6` |
| `name` | `VARCHAR(255)` | No | The display name of the property. | `Burj Al Yassmin` |
| `address` | `TEXT` | Yes | The full street address of the property. | `Riyadh, Al Yassmin District` |
| `status` | `VARCHAR(50)` | No | The current status of the property (`ACTIVE`, `ARCHIVED`). | `ACTIVE` |

## Table: `units`

Stores information about individual units within a property.

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `UUID` | No | Primary Key, unique identifier for the unit. | `c1d2e3f4-a5b6-c7d8-e9f0-a1b2c3d4e5f6` |
| `property_id` | `UUID` | No | Foreign key to the `properties` table. | `b1c2d3e4-f5a6-b7c8-d9e0-f1a2b3c4d5e6` |
| `unit_number` | `VARCHAR(50)` | No | The number or identifier of the unit within the property. | `A-101` |
| `status` | `VARCHAR(50)` | No | The occupancy status of the unit (`VACANT`, `OCCUPIED`, `RESERVED`). | `VACANT` |
| `annual_rent` | `DECIMAL(12, 2)` | Yes | The default annual rent for the unit. | `45000.00` |

## Table: `tenants`

Stores information about tenants (individuals or companies leasing units).

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `UUID` | No | Primary Key, unique identifier for the tenant. | `d1e2f3a4-b5c6-d7e8-f9a0-b1c2d3e4f5a6` |
| `full_name_encrypted` | `VARCHAR(512)` | No | **Restricted**. Tenant's full name, encrypted. | `[Encrypted Data]` |
| `national_id_encrypted` | `VARCHAR(512)` | No | **Restricted**. Tenant's National ID / Iqama, encrypted. | `[Encrypted Data]` |
| `phone_number_encrypted` | `VARCHAR(512)` | No | **Restricted**. Tenant's phone number, encrypted. | `[Encrypted Data]` |
| `verification_status` | `VARCHAR(50)` | No | Status of Nafath identity verification (`PENDING`, `VERIFIED`, `FAILED`). | `VERIFIED` |

## Table: `contracts`

Stores lease contract information.

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `UUID` | No | Primary Key, unique identifier for the contract. | `e1f2a3b4-c5d6-e7f8-a9b0-c1d2e3f4a5b6` |
| `unit_id` | `UUID` | No | Foreign key to the `units` table. | `c1d2e3f4-a5b6-c7d8-e9f0-a1b2c3d4e5f6` |
| `tenant_id` | `UUID` | No | Foreign key to the `tenants` table. | `d1e2f3a4-b5c6-d7e8-f9a0-b1c2d3e4f5a6` |
| `start_date` | `DATE` | No | The start date of the lease. | `2026-03-01` |
| `end_date` | `DATE` | No | The end date of the lease. | `2027-02-28` |
| `status` | `VARCHAR(50)` | No | The status of the contract (`DRAFT`, `ACTIVE`, `EXPIRED`). | `ACTIVE` |
| `ejar_contract_id` | `VARCHAR(255)` | Yes | The unique ID returned by the Ejar system. | `EJAR-123456789` |

## Table: `invoices`

Stores payment invoices generated from contract installments.

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `UUID` | No | Primary Key, unique identifier for the invoice. | `f1a2b3c4-d5e6-f7a8-b9c0-d1e2f3a4b5c6` |
| `installment_id` | `UUID` | No | Foreign key to the `installments` table. | `...` |
| `status` | `VARCHAR(50)` | No | The status of the invoice (`PENDING`, `PAID`, `OVERDUE`). | `PAID` |
| `sadad_bill_number` | `VARCHAR(255)` | No | The unique bill number generated by SADAD. | `SADAD-ABC123XYZ` |

## Table: `payments`

Stores records of actual payments received.

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `UUID` | No | Primary Key, unique identifier for the payment. | `a2b3c4d5-e6f7-a8b9-c0d1-e2f3a4b5c6d7` |
| `invoice_id` | `UUID` | No | Foreign key to the `invoices` table. | `f1a2b3c4-d5e6-f7a8-b9c0-d1e2f3a4b5c6` |
| `amount_paid` | `DECIMAL(12, 2)` | No | The amount that was actually paid. | `3750.00` |
| `payment_date` | `TIMESTAMPTZ` | No | The timestamp of when the payment was confirmed. | `2026-04-01 14:30:00+03` |
| `method` | `VARCHAR(50)` | No | The method of payment (`SADAD`, `MANUAL`, `VISA`). | `SADAD` |
| `reference_number` | `VARCHAR(255)` | Yes | The transaction reference from the payment gateway. | `SADAD-REF-XYZ789` |

## Table: `audit_logs`

Stores a log of all critical actions performed in the system for security and compliance.

| Column | Data Type | Nullable | Description | Example |
|---|---|---|---|---|
| `id` | `BIGSERIAL` | No | Primary Key, auto-incrementing log entry ID. | `10542` |
| `user_id` | `UUID` | Yes | The user who performed the action. Null if system action. | `a1b2c3d4-e5f6-7890-1234-567890abcdef` |
| `action` | `VARCHAR(255)` | No | The type of action performed. | `CONTRACT_CREATED` |
| `resource_type` | `VARCHAR(100)` | Yes | The type of resource affected (e.g., 'Contract'). | `Contract` |
| `resource_id` | `UUID` | Yes | The ID of the affected resource. | `e1f2a3b4-c5d6-e7f8-a9b0-c1d2e3f4a5b6` |
| `details` | `JSONB` | Yes | A JSON object with additional details about the event. | `{"oldStatus": "DRAFT", "newStatus": "ACTIVE"}` |
| `ip_address` | `VARCHAR(100)` | Yes | The IP address from which the action was initiated. | `192.168.1.100` |
| `created_at` | `TIMESTAMPTZ` | No | The timestamp of when the action occurred. | `2026-02-16 11:05:10+03` |
